<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mystic Oracle v4.0</title> <link rel="icon" href="data:,">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8501135338572495" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #ffd700; --gold-dim: #b8860b; --purple: #9c27b0; --deep-bg: #0a0112; --glass: rgba(10, 5, 20, 0.85); --border: rgba(255, 215, 0, 0.3); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { background-color: var(--deep-bg); background-image: radial-gradient(circle at 50% 100%, #2a0a40, #000); color: #e0c3fc; font-family: 'Poppins', sans-serif; margin: 0; min-height: 100vh; display: flex; flex-direction: column; align-items: center; overflow-x: hidden; position: relative; }
        #mystic-alert { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.8); background: var(--glass); border: 2px solid var(--gold); padding: 25px; border-radius: 20px; z-index: 99999; text-align: center; display: none; opacity: 0; box-shadow: 0 0 50px rgba(0,0,0,1), 0 0 20px var(--purple); transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); width: 85%; max-width: 320px; }
        #mystic-alert.show { opacity: 1; transform: translate(-50%, -50%) scale(1); display: block; }
        .alert-btn { margin-top: 20px; background: var(--gold); color: #000; border: none; padding: 10px 25px; border-radius: 15px; font-weight: bold; cursor: pointer; font-family: 'Cinzel'; }
        .online-status { position: fixed; top: 20px; left: 20px; display: flex; align-items: center; gap: 8px; background: rgba(0,0,0,0.5); padding: 5px 12px; border-radius: 20px; border: 1px solid rgba(0, 255, 204, 0.3); font-size: 11px; color: #00ffcc; z-index: 1000; }
        .online-dot { width: 8px; height: 8px; background: #00ffcc; border-radius: 50%; animation: blinkOnline 1.5s infinite; }
        #star-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -3; }
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0; animation: twinkle ease-in-out infinite; }
        #fog { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url('https://raw.githubusercontent.com/s1mpson-/assets/master/fog.png') repeat; opacity: 0.05; z-index: -2; animation: fogMove 60s linear infinite; pointer-events: none; }
        @keyframes fogMove { 0% { background-position: 0 0; } 100% { background-position: 1000px 0; } }
        #welcome-overlay { position: fixed; inset: 0; background: var(--deep-bg); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 20000; transition: opacity 1s ease-out; }
        .wizard-gif { font-size: 80px; filter: drop-shadow(0 0 20px var(--gold)); animation: wizardFloat 3s infinite ease-in-out; }
        .container { width: 95%; max-width: 1100px; display: grid; grid-template-columns: 1fr; gap: 25px; margin-top: 30px; margin-bottom: 50px; z-index: 10; }
        @media (min-width: 992px) { .container { grid-template-columns: 320px 1fr; } }
        .panel { background: var(--glass); border: 1px solid var(--border); border-radius: 24px; padding: 30px; position: relative; }
        input, select, textarea { width: 100%; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: #fff; margin-top: 5px; }
        .tab-btn { padding: 16px; text-align: left; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: #ddd; cursor: pointer; border-radius: 12px; margin-bottom: 10px; width: 100%; transition: 0.3s; }
        .tab-btn.active { background: linear-gradient(90deg, #7b1fa2, transparent); border-left: 4px solid var(--gold); color: #fff; }
        .grid-area { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; }
        .card-item { background: rgba(255,215,0,0.05); border: 1px solid var(--gold); color: var(--gold); padding: 15px 5px; border-radius: 10px; text-align: center; cursor: pointer; font-size: 10px; }
        .card-item.selected { background: var(--gold); color: #000; box-shadow: 0 0 15px var(--gold); }
        .tarot-card { perspective: 1000px; height: 120px; cursor: pointer; }
        .tarot-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .tarot-card.flipped .tarot-inner { transform: rotateY(180deg); }
        .tarot-front, .tarot-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 10px; border: 1px solid var(--gold); display: flex; align-items: center; justify-content: center; flex-direction: column; }
        .tarot-back { background: linear-gradient(135deg, #1a0033, #4a0072); color: var(--gold); font-size: 20px; }
        .tarot-front { background: rgba(123, 31, 162, 0.8); transform: rotateY(180deg); color: #fff; font-size: 9px; padding: 5px; text-align: center; }
        .main-btn { background: linear-gradient(135deg, #4a0072, #7b1fa2); color: #fff; border: 1px solid var(--gold); padding: 18px; border-radius: 16px; font-weight: bold; cursor: pointer; margin-top: 20px; width: 100%; letter-spacing: 1px; font-family: 'Cinzel'; }
        #sonucAlani { display: none; margin-top: 25px; padding: 25px; background: rgba(0,0,0,0.8); border-left: 4px solid var(--gold); border-radius: 16px; line-height: 1.7; color: #f0e6ff; text-align: justify; }
        
        .image-box { margin-top: 15px; border: 2px dashed rgba(255, 215, 0, 0.3); border-radius: 16px; min-height: 180px; display: flex; flex-wrap: wrap; align-items: center; justify-content: center; gap: 10px; padding: 15px; background: rgba(0,0,0,0.2); }
        .gallery-item { position: relative; width: 80px; height: 80px; }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; border-radius: 10px; border: 1px solid var(--gold); }
        .remove-btn { position: absolute; top: -5px; right: -5px; background: #ff4444; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 12px; cursor: pointer; font-weight: bold; border: 1px solid white; z-index: 10; }
        .add-more-btn { width: 80px; height: 80px; border: 2px dashed var(--gold); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 30px; color: var(--gold); cursor: pointer; background: rgba(255,215,0,0.05); }

        .planet-row { display: flex; justify-content: space-between; font-size: 11px; margin-top: 8px; padding: 5px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .history-bar-container { width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; margin: 5px 0 15px 0; }
        .history-bar-fill { height: 100%; background: var(--gold); border-radius: 2px; width: 0; transition: width 1s; }
        #surpriz-kutu { background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), transparent); border: 1px solid var(--gold); border-radius: 15px; padding: 15px; margin-top: 20px; text-align: center; cursor: pointer; transition: 0.3s; }
        .side-icon { position: fixed; top: 50%; transform: translateY(-50%); width: 280px; opacity: 0.1; z-index: -1; pointer-events: none; filter: drop-shadow(0 0 10px var(--gold)); }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
        
        .remember-container { display: flex; align-items: center; gap: 8px; margin-top: 15px; padding-left: 5px; }
        .remember-checkbox { width: 16px; height: 16px; accent-color: var(--gold); cursor: pointer; margin: 0; }
        .remember-label { font-size: 11px; color: #ccc; cursor: pointer; user-select: none; }
    </style>
</head>
<body>
    <div id="mystic-alert"><div id="alert-icon" style="font-size: 40px; margin-bottom: 10px;">üîÆ</div><div id="alert-text"></div><button class="alert-btn" onclick="closeAlert()">ANLADIM</button></div>
    <div class="online-status"><div class="online-dot"></div><span>142 √áevrimi√ßi K√¢hin</span></div>
    <div id="welcome-overlay"><div class="wizard-gif">üßô‚ú®</div><div style="text-align:center; color:gold; font-family:'Cinzel'; margin-top:20px;">Mystic Oracle'a Ho≈ü Geldin<br><span style="font-size: 14px; opacity: 0.8;">Kaderin Yƒ±ldƒ±zlarda Saklƒ±...</span></div></div>
    <div id="star-container"></div><div id="fog"></div>
    <audio id="bgMusic" loop><source src="https://actions.google.com/sounds/v1/horror/ambient_hum_creepy.ogg" type="audio/ogg"></audio>
    <div id="mainAppContent" style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        <div class="header" style="text-align:center; margin-top:40px; position:relative;">
            <div class="top-controls" style="position: absolute; right: -50px; top: -10px;"><button onclick="toggleMusic()" style="background:none; border:none; cursor:pointer; font-size:24px;">üéµ</button></div>
            <h1 id="siteMainTitle" style="font-family:'Cinzel'; font-size: clamp(24px, 8vw, 40px); color: gold; margin:0;">MYSTIC ORACLE <span style="font-size:12px; color:white;">v4.0 Final</span></h1>
            <div id="liveClock" style="font-size: 11px; color:gold; margin-top: 5px; opacity:0.7;"></div>
        </div>
        <div class="container">
            <div class="panel">
                <h3 style="color:gold; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:10px; margin-top:0;">üë§ ANALƒ∞Z PROFƒ∞Lƒ∞</h3>
                <label style="font-size:10px; color:gold; display:block; margin-top:15px; letter-spacing:1px;">ƒ∞SMƒ∞Nƒ∞Z *</label><input type="text" id="userName" placeholder="ƒ∞sim Giriniz">
                <label style="font-size:10px; color:gold; display:block; margin-top:15px; letter-spacing:1px;">DOƒûUM TARƒ∞Hƒ∞ *</label><input type="date" id="dob" onchange="calcAstro()">
                
                <div class="remember-container">
                    <input type="checkbox" id="rememberMe" class="remember-checkbox">
                    <label for="rememberMe" class="remember-label">Beni Hatƒ±rla (Bilgilerimi Kaydet)</label>
                </div>

                <div id="surpriz-kutu" onclick="surprizAc()"><span id="kutu-ikon">üéÅ</span><div id="kutu-metin" style="font-size: 11px; color: #fff; font-style: italic;">G√ºn√ºn Kader Sandƒ±ƒüƒ±nƒ± A√ß...</div></div>
                <div id="planet-monitor" style="margin-top:20px;"></div>
                <div style="margin-top:20px;"><div style="font-size: 9px; color: var(--gold);">RUHSAL G√ú√á</div><div class="history-bar-container"><div id="bar-spirit" class="history-bar-fill"></div></div><div style="font-size: 9px; color: var(--gold);">A≈ûK ENERJƒ∞Sƒ∞</div><div class="history-bar-container"><div id="bar-love" class="history-bar-fill" style="background: #e91e63;"></div></div></div>
                <div id="astroInfo" style="text-align:center; margin-top:15px; color:gold; font-weight:bold;"></div>
                <div style="margin-top:25px;" id="menuContainer"></div>
            </div>
            <div class="panel">
                <h2 id="t-active-title" style="margin-top:0; color:gold; font-family:'Cinzel'; text-align:center; font-size:18px;"></h2>
                <div id="section-photo">
                    <div class="image-box" id="imgPreview">
                        <div class="add-more-btn" onclick="document.getElementById('imgInput').click()">+</div>
                    </div>
                    <input type="file" id="imgInput" accept="image/*" style="display:none;" onchange="handleMultipleImages(this)">
                </div>
                <div id="section-grid" style="display:none;" class="grid-area"></div>
                <div id="section-dream" style="display:none;"><textarea id="dreamData" rows="6" placeholder="R√ºyanƒ± detaylƒ±ca fƒ±sƒ±lda..."></textarea></div>
                <button class="main-btn" onclick="runOracle()">KEHANETƒ∞ BA≈ûLAT</button>
                <div id="loader" style="display:none; text-align:center; margin-top:20px; color:var(--gold); font-size:14px; font-weight:bold; animation: pulse 1s infinite;">‚ú® Kaderin Okunuyor...</div>
                <div id="sonucAlani"><div id="sonucText"></div></div>
            </div>
        </div>
    </div>
<script>
    // --- FATƒ∞H'ƒ∞N GEMINI API ANAHTARI ---
    const apiKey = ""; // Burayƒ± bo≈ü bƒ±rakƒ±yoruz, birazdan g√ºvenli hale getireceƒüiz

    let activeIdx = 0; let selectedImages = []; let tarotStack = []; let zodiacSelected = "";
    const menuItems = ["Kahve Falƒ±", "El Falƒ±", "Tarot", "Bur√ßlar", "R√ºyalar", "Numeroloji"];
    const signs = ["Ko√ß","Boƒüa","ƒ∞kizler","Yenge√ß","Aslan","Ba≈üak","Terazi","Akrep","Yay","Oƒülak","Kova","Balƒ±k"];
    const tarotNames = ["√ñl√ºm","A≈üƒ±klar","Kule","Yƒ±ldƒ±z","Ay","G√ºne≈ü","D√ºnya","Adalet","B√ºy√ºc√º","Ermi≈ü","≈ûeytan","Aptal"];
    const surprizler = [{i:"üóùÔ∏è", n:"G√ºm√º≈ü Anahtar", m:"Fƒ±rsat kapƒ±da."}, {i:"ü™∂", n:"Anka T√ºy√º", m:"Ruhun yenileniyor."}];

    function renderMenu() {
        const container = document.getElementById('menuContainer'); container.innerHTML = '';
        menuItems.forEach((name, i) => {
            const b = document.createElement('button'); b.className = `tab-btn ${i===activeIdx?'active':''}`;
            b.innerText = name; b.onclick = () => { 
                activeIdx = i; tarotStack = []; zodiacSelected = ""; selectedImages = [];
                document.getElementById('sonucAlani').style.display = 'none'; renderMenu();
                document.getElementById('t-active-title').innerText = name;
                document.getElementById('section-photo').style.display = (i<2)?"block":"none";
                document.getElementById('section-grid').style.display = (i===2||i===3)?"grid":"none";
                document.getElementById('section-dream').style.display = (i===4)?"block":"none";
                if(i<2) updateGalleryUI();
                if(i===2) loadGrid('tarot'); if(i===3) loadGrid('signs');
            };
            container.appendChild(b);
            if(i===activeIdx) document.getElementById('t-active-title').innerText = name;
        });
    }

    function loadGrid(mode) {
        const grid = document.getElementById('section-grid'); grid.innerHTML = '';
        if(mode === 'signs') {
            signs.forEach(s => {
                const el = document.createElement('div'); el.className = 'card-item'; el.innerText = s;
                el.onclick = () => { document.querySelectorAll('.card-item').forEach(x=>x.classList.remove('selected')); el.classList.add('selected'); zodiacSelected = s; };
                grid.appendChild(el);
            });
        } else {
            tarotNames.forEach((n, i) => {
                const el = document.createElement('div'); el.className = 'tarot-card';
                el.innerHTML = `<div class="tarot-inner"><div class="tarot-back">?</div><div class="tarot-front">${n}</div></div>`;
                el.onclick = () => { if(tarotStack.length<3 && !el.classList.contains('flipped')) { el.classList.add('flipped'); tarotStack.push(n); } };
                grid.appendChild(el);
            });
        }
    }

    function handleMultipleImages(input) {
        if(input.files[0]){
            const r = new FileReader();
            r.onload=(e)=>{ selectedImages.push(e.target.result); updateGalleryUI(); };
            r.readAsDataURL(input.files[0]);
            input.value = "";
        }
    }

    function removeImage(idx) { selectedImages.splice(idx, 1); updateGalleryUI(); }

    function updateGalleryUI() {
        const preview = document.getElementById('imgPreview'); preview.innerHTML = '';
        selectedImages.forEach((src, index) => {
            const div = document.createElement('div'); div.className = 'gallery-item';
            div.innerHTML = `<img src="${src}"><div class="remove-btn" onclick="removeImage(${index})">X</div>`;
            preview.appendChild(div);
        });
        if(selectedImages.length < 5) {
            const addBtn = document.createElement('div'); addBtn.className = 'add-more-btn';
            addBtn.innerText = '+'; addBtn.onclick = () => document.getElementById('imgInput').click();
            preview.appendChild(addBtn);
        }
    }

    function saveUserData() {
        if(document.getElementById('rememberMe').checked) {
            const data = {
                name: document.getElementById('userName').value,
                dob: document.getElementById('dob').value
            };
            localStorage.setItem('mysticUser', JSON.stringify(data));
        } else {
            localStorage.removeItem('mysticUser');
        }
    }

    function loadUserData() {
        const data = localStorage.getItem('mysticUser');
        if(data) {
            const u = JSON.parse(data);
            document.getElementById('userName').value = u.name || "";
            document.getElementById('dob').value = u.dob || "";
            document.getElementById('rememberMe').checked = true;
            if(u.dob) calcAstro();
        }
    }

    // --- OTOMATƒ∞K MODEL TESPƒ∞T Sƒ∞STEMƒ∞ ---
    async function getWorkingModel() {
        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${GEMINI_API_KEY}`);
            const data = await response.json();
            if (data.models) {
                const found = data.models.find(m => m.name.includes("gemini") && m.supportedGenerationMethods.includes("generateContent"));
                if (found) return found.name.replace("models/", ""); 
            }
        } catch (e) { console.warn("Model hatasƒ±:", e); }
        return "gemini-1.5-flash"; 
    }

    async function runOracle() {
        const n = document.getElementById('userName').value;
        const d = document.getElementById('dob').value;
        saveUserData();

        const loader = document.getElementById('loader');
        if(!n || !d) { showMysticAlert("√ñnce ismini ve doƒüum tarihini fƒ±sƒ±lda..."); return; }
        const age = new Date().getFullYear() - new Date(d).getFullYear();
        if(activeIdx < 2 && selectedImages.length === 0) { showMysticAlert("Fincanƒ±nƒ± veya elini g√∂rmeden nasƒ±l bakayƒ±m? Fotoƒüraf y√ºkle."); return; }
        if(activeIdx === 3 && !zodiacSelected) { showMysticAlert("Hangi bur√ßtan olduƒüunu se√ßmedin."); return; }

        loader.style.display = 'block'; document.getElementById('sonucAlani').style.display = 'none';

        // --- Kƒ∞MLƒ∞K VE TON AYARI ---
        let identity = ""; let task = "";
        // KESƒ∞LMEYƒ∞ √ñNLEMEK ƒ∞√áƒ∞N KESƒ∞N EMƒ∞RLER
        let details = `
        KURALLAR:
        1. C√úMLELERƒ∞Nƒ∞ ASLA YARIDA BIRAKMA. Eƒüer kelime sƒ±nƒ±rƒ±na yakla≈üƒ±rsan konuyu hemen toparla ve veda et.
        2. Falcƒ± Teyze gibi konu≈ü: "Bak ≈üurada...", "Yavrum..." de.
        3. G√∂rd√ºklerini kanƒ±tla (Kulp tarafƒ±, tabaƒüƒ±n ortasƒ± vb.).
        4. Ortalama 250 kelime yaz. √áok uzun yazmaya √ßalƒ±≈üma, √∂z ve etkileyici olsun.
        5. En sonunda mutlaka "Hadi kendine iyi bak, yine beklerim" gibi bir c√ºmle ile Bƒ∞Tƒ∞R.
        `;

        if(activeIdx === 0) { // KAHVE
            identity = "Sen mahallenin en me≈ühur Falcƒ± Teyze'sisin.";
            task = `G√ñREVƒ∞N: Fotoƒüraftaki kahve fincanƒ±nƒ± ${n} (${age} ya≈ü) i√ßin yorumla. ≈ûekilleri (hayvan, harf, yol) bul ve bunlarƒ±n anlamƒ±nƒ± s√∂yle.`;
        } else if(activeIdx === 1) { // EL FALI
            identity = "Sen El Falƒ± √ústadƒ±sƒ±n.";
            task = `G√ñREVƒ∞N: El fotoƒürafƒ±ndaki √ßizgileri (Hayat, Kalp, Akƒ±l) ${n} i√ßin yorumla.`;
        } else if(activeIdx === 2) { // TAROT
            identity = "Sen Tarot Okuyucusu'sun.";
            task = `G√ñREVƒ∞N: Kartlar: ${tarotStack.join(' + ')}. ${n} i√ßin yorumla.`;
        } else if(activeIdx === 3) { // BUR√áLAR
            identity = "Sen Astrologsun.";
            task = `G√ñREVƒ∞N: ${zodiacSelected} burcu i√ßin bug√ºn√ºn yorumunu yap.`;
        } else if(activeIdx === 4) { // R√úYALAR
            identity = "Sen R√ºya Tabircisisin.";
            task = `G√ñREVƒ∞N: ≈ûu r√ºyayƒ± yorumla: "${document.getElementById('dreamData').value}".`;
        } else { // NUMEROLOJƒ∞
            identity = "Sen Numerologsun.";
            task = `G√ñREVƒ∞N: ${d} doƒüumlu ${n} i√ßin ya≈üam yolu sayƒ±sƒ±nƒ± yorumla.`;
        }

        const promptText = `Kƒ∞MLƒ∞K: ${identity}\nKULLANICI: ${n}\n${task}\n${details}`;

        try {
            let partsArray = [{ text: promptText }];
            if (activeIdx === 0 || activeIdx === 1) {
                selectedImages.forEach(base64Str => {
                    partsArray.push({ inline_data: { mime_type: base64Str.split(';')[0].split(':')[1], data: base64Str.split(',')[1] } });
                });
            }

            const modelName = await getWorkingModel();
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${GEMINI_API_KEY}`;
            
            const response = await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: partsArray }],
                    // Token sayƒ±sƒ± 4000 olarak g√ºncellendi.
                    generationConfig: { temperature: 1.0, maxOutputTokens: 4000 }, 
                    safetySettings: [
                        { category: "HARM_CATEGORY_HARASSMENT", threshold: "BLOCK_NONE" },
                        { category: "HARM_CATEGORY_HATE_SPEECH", threshold: "BLOCK_NONE" },
                        { category: "HARM_CATEGORY_SEXUALLY_EXPLICIT", threshold: "BLOCK_NONE" },
                        { category: "HARM_CATEGORY_DANGEROUS_CONTENT", threshold: "BLOCK_NONE" }
                    ]
                })
            });

            const data = await response.json();
            loader.style.display = 'none';

            if (data.error) { showMysticAlert("Fincan soƒüumu≈ü, enerjini alamadƒ±m. (Hata)"); return; }
            let finalText = data.candidates[0].content.parts[0].text.trim();

            // KESƒ∞LME KONTROL√ú (YAPAY ZEKA YARIM BIRAKIRSA Bƒ∞Z TAMAMLIYORUZ)
            if (!/[.!?]$/.test(finalText)) {
                 finalText += "... (Neyse kuzum, enerjim bu kadar yetti. Sen g√∂nl√ºn√º ferah tut, her ≈üey g√ºzel olacak. Hadi kendine iyi bak.)";
            }

            if (finalText.includes("ERROR_CUP")) { showMysticAlert("Bu fincan deƒüil ki?"); return; }

            document.getElementById('sonucText').innerText = finalText;
            document.getElementById('sonucAlani').style.display = 'block';
            updateEnergyBars();

        } catch (e) { 
            console.error(e);
            loader.style.display = 'none'; 
            showMysticAlert("Baƒülantƒ± koptu, tekrar dene."); 
        }
    }
    
    function surprizAc() { const n=document.getElementById('userName').value; if(!n){showMysticAlert("ƒ∞smini s√∂yle.");return;} const s=surprizler[Math.floor(Math.random()*surprizler.length)]; document.getElementById('kutu-ikon').innerHTML=s.i; document.getElementById('kutu-metin').innerHTML=`<b>${s.n}</b>: ${s.m}`; }
    function showMysticAlert(t) { document.getElementById('alert-text').innerText=t; const b=document.getElementById('mystic-alert'); b.style.display="block"; setTimeout(()=>b.classList.add('show'),10); }
    function closeAlert() { document.getElementById('mystic-alert').classList.remove('show'); setTimeout(()=>document.getElementById('mystic-alert').style.display="none",300); }
    function syncPlanets() { const p=[{n:"Merk√ºr",v:72},{n:"Ven√ºs",v:45},{n:"Mars",v:88},{n:"J√ºpiter",v:94}]; document.getElementById('planet-monitor').innerHTML=p.map(x=>`<div class="planet-row"><span>${x.n}</span><span style="color:gold">%${x.v}</span></div>`).join(''); }
    function updateEnergyBars() { document.getElementById('bar-spirit').style.width=(Math.floor(Math.random()*40)+60)+"%"; document.getElementById('bar-love').style.width=(Math.floor(Math.random()*40)+50)+"%"; }
    function toggleMusic() { const m=document.getElementById('bgMusic'); m.paused?m.play():m.pause(); }
    function calcAstro() { 
        const d=document.getElementById('dob').value; if(!d)return; 
        const date = new Date(d);
        const day = date.getDate(); const month = date.getMonth() + 1;
        let sign = "";
        if ((month == 3 && day >= 21) || (month == 4 && day <= 19)) sign = "Ko√ß";
        else if ((month == 4 && day >= 20) || (month == 5 && day <= 20)) sign = "Boƒüa";
        else if ((month == 5 && day >= 21) || (month == 6 && day <= 20)) sign = "ƒ∞kizler";
        else if ((month == 6 && day >= 21) || (month == 7 && day <= 22)) sign = "Yenge√ß";
        else if ((month == 7 && day >= 23) || (month == 8 && day <= 22)) sign = "Aslan";
        else if ((month == 8 && day >= 23) || (month == 9 && day <= 22)) sign = "Ba≈üak";
        else if ((month == 9 && day >= 23) || (month == 10 && day <= 22)) sign = "Terazi";
        else if ((month == 10 && day >= 23) || (month == 11 && day <= 21)) sign = "Akrep";
        else if ((month == 11 && day >= 22) || (month == 12 && day <= 21)) sign = "Yay";
        else if ((month == 12 && day >= 22) || (month == 1 && day <= 19)) sign = "Oƒülak";
        else if ((month == 1 && day >= 20) || (month == 2 && day <= 18)) sign = "Kova";
        else sign = "Balƒ±k";
        document.getElementById('astroInfo').innerText="G√ºne≈ü Burcun: "+sign; 
    }
    window.onload = () => { loadUserData(); syncPlanets(); updateEnergyBars(); renderMenu(); updateGalleryUI(); const sc=document.getElementById('star-container'); for(let i=0;i<60;i++){const s=document.createElement('div');s.className='star';s.style.left=Math.random()*100+'%';s.style.top=Math.random()*100+'%';s.style.width='2px';s.style.height='2px';s.style.animationDuration=(Math.random()*3+2)+'s';sc.appendChild(s);} setTimeout(()=>{const o=document.getElementById('welcome-overlay');if(o){o.style.opacity='0';setTimeout(()=>o.remove(),800);}},1500); setInterval(()=>{document.getElementById('liveClock').innerText=new Date().toLocaleString('tr-TR');},1000); tarotNames.sort(()=>Math.random()-0.5); };
</script>
</body>
</html>